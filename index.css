:root {
  /* Core Palette */
  --text-primary: #f5f5f7;
  --text-secondary: rgba(235, 235, 245, 0.6);
  --text-placeholder: rgba(235, 235, 245, 0.4);

  /* Accents */
  --accent-purple: #c084fc; 
  --accent-purple-glow: hsla(262, 92%, 77%, 0.4);
  --accent-green: #32D74B;
  --accent-red: #FF453A;
  --accent-yellow: #FFD60A;
  
  /* --- Corrected Glass UI System --- */
  /* Main panels like task lists, progress cards */
  --glass-bg-panel: rgba(30, 30, 30, 0.75);
  /* Hover state for main panels */
  --glass-bg-panel-hover: rgba(45, 45, 45, 0.8);
  /* Sidebar and Header for hierarchy */
  --glass-bg-chrome: rgba(18, 18, 18, 0.8);
  /* Buttons */
  --glass-bg-button-primary: hsla(262, 92%, 77%, 0.25);
  --glass-bg-button-primary-hover: hsla(262, 92%, 77%, 0.4);
  --glass-bg-button-secondary: rgba(80, 80, 80, 0.5);
  --glass-bg-button-secondary-hover: rgba(100, 100, 100, 0.6);
  
  --glass-backdrop-blur: blur(24px) saturate(180%);
  --glass-border-color: rgba(255, 255, 255, 0.1);
  --glass-border-color-hover: rgba(255, 255, 255, 0.25);
  --glass-inner-highlight: inset 0 1px 1px 0 rgba(255, 255, 255, 0.05);

  /* Mappings for components */
  --background-secondary: var(--glass-bg-chrome);
  --background-tertiary: var(--glass-bg-panel);
  --background-tertiary-hover: var(--glass-bg-panel-hover);
  --glass-background-panel: var(--glass-bg-panel);
  --glass-background-button: var(--glass-bg-button-primary);
  --glass-background-button-hover: var(--glass-bg-button-primary-hover);

  /* Separators */
  --separator-primary: rgba(84, 84, 88, 0.65);
  --separator-secondary: rgba(84, 84, 88, 0.4);

  /* Sizing & Z-Index */
  --border-radius-sm: 10px;
  --border-radius-md: 16px;
  --border-radius-lg: 20px;

  --z-header: 50;
  --z-sidebar-mobile-backdrop: 90;
  --z-sidebar-mobile: 100;
  --z-modal: 110;
  --z-notification: 120;
}

/* --- 1. Base Setup & THE DEFINITIVE Wallpaper Fix --- */
html, body {
  height: 100%;
  background-color: #000; /* Fallback background */
  color: var(--text-primary);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-tap-highlight-color: transparent;
  overflow: hidden; /* Prevent body scrolling */
}

#root {
  height: 100%;
  background-color: transparent; /* VERY IMPORTANT: React root must be see-through */
  
  /* CRITICAL: Create a new stacking context. This ensures the background div with z-index: -1 stays behind other content within #root. */
  position: relative;
  isolation: isolate;
  z-index: 0;
}

.background-wallpaper {
  position: fixed;
  inset: -20px; /* Overscan to prevent blurry edges on some screens */
  /* z-index: -1; - REMOVED to fix a rendering bug in Safari where the wallpaper would not appear. */
  background: url('/light-stream-blue-big-sur-kf.jpg') no-repeat center center;
  background-size: cover;
  filter: blur(24px) brightness(0.6);
  transform: scale(1.1); /* Zoom in slightly to fill overscan area */
}

.main-content-wrapper {
  position: relative;
  z-index: 1; /* Ensures all app content renders on top of the wallpaper. */
  isolation: isolate; /* Creates a new stacking context for the content. */
}


/* --- 2. Glass Panel System --- */
.static-glow-border,
.interactive-glow-border,
.modal-panel,
.input-base,
.custom-select-button {
  background-color: var(--glass-bg-panel);
  -webkit-backdrop-filter: var(--glass-backdrop-blur);
  backdrop-filter: var(--glass-backdrop-blur);
  border: 1px solid var(--glass-border-color);
  box-shadow: var(--glass-inner-highlight);
  transition: box-shadow 0.3s ease, border-color 0.3s ease, background-color 0.3s ease;
}

.interactive-glow-border:hover {
  background-color: var(--glass-bg-panel-hover);
  border-color: var(--glass-border-color-hover);
  box-shadow: var(--glass-inner-highlight), 0 0 12px var(--accent-purple-glow);
}

/* --- 3. Component-Specific Styling --- */

/* App Chrome: Header & Sidebar */
header, aside {
  background-color: var(--glass-bg-chrome);
  -webkit-backdrop-filter: var(--glass-backdrop-blur);
  backdrop-filter: var(--glass-backdrop-blur);
  border-color: var(--glass-border-color); /* Uses border-right/bottom */
}

/* Buttons */
.button-base {
  border: 1px solid var(--glass-border-color);
  -webkit-backdrop-filter: var(--glass-backdrop-blur);
  backdrop-filter: var(--glass-backdrop-blur);
  box-shadow: var(--glass-inner-highlight);
}
.button-primary {
  background-color: var(--glass-bg-button-primary);
}
.button-primary:hover {
  background-color: var(--glass-bg-button-primary-hover);
  border-color: var(--glass-border-color-hover);
}
.button-secondary {
  background-color: var(--glass-bg-button-secondary);
}
.button-secondary:hover {
  background-color: var(--glass-bg-button-secondary-hover);
  border-color: var(--glass-border-color-hover);
}
.button-danger {
  background-color: hsla(4, 80%, 50%, 0.5);
  border-color: hsla(4, 80%, 60%, 0.5);
}
.button-danger:hover {
  background-color: hsla(4, 80%, 50%, 0.7);
  border-color: hsla(4, 80%, 60%, 0.7);
}
.button-ghost {
  background-color: transparent;
  border-color: transparent;
  box-shadow: none;
  -webkit-backdrop-filter: none;
  backdrop-filter: none;
}
.button-ghost:hover {
  background-color: hsla(262, 92%, 77%, 0.15);
}

/* Modals */
.modal-panel {
  box-shadow: 0 16px 40px rgba(0, 0, 0, 0.5);
}

/* Forms */
.input-base {
  color: var(--text-primary);
}
.input-base::placeholder { color: var(--text-placeholder); }
.input-base:focus, .input-base:focus-visible {
  outline: none;
  border-color: var(--accent-purple);
  box-shadow: 0 0 12px var(--accent-purple-glow), var(--glass-inner-highlight);
}

/* --- 4. Utilities & Overrides --- */
.text-xxs { font-size: 0.65rem; line-height: 0.9rem; }
.rounded-lg { border-radius: var(--border-radius-lg); }
.rounded-md { border-radius: var(--border-radius-md); }
.rounded-sm { border-radius: var(--border-radius-sm); }
.isolated-scroll { overscroll-behavior: contain; }

::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.3); }

/* Safe Area Paddings */
.sidebar-content-area {
    padding: 0.75rem;
    padding-left: calc(0.75rem + env(safe-area-inset-left));
    padding-right: calc(0.75rem + env(safe-area-inset-right));
    padding-top: calc(0.75rem + env(safe-area-inset-top));
    padding-bottom: calc(3rem + env(safe-area-inset-bottom));
}

/* Focus Rings */
*:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--glass-bg-chrome), 0 0 0 4px var(--accent-purple);
}
/* Disable focus ring for elements that have their own focus styles */
.input-base:focus-visible, 
button:focus-visible,
[role="button"]:focus-visible,
.custom-select-button:focus-visible {
    box-shadow: none;
}
.interactive-glow-border:focus-visible {
  border-color: var(--accent-purple);
  box-shadow: 0 0 12px var(--accent-purple-glow), var(--glass-inner-highlight);
}


/* Print Styles */
@media print {
  @page { size: A4 portrait; margin: 0.75in; }
  html, body { background: #fff !important; color: #000 !important; }
  body::before { display: none; }
  .schedule-report-day { break-inside: avoid; padding: 1rem; border: 1px solid #d1d5db; border-radius: 0.5rem; }
  .new-week-page-break { break-before: page; }
}