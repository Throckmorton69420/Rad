/* Liquid Glass visionOS Theme - 3.0 */
:root {
  /* Core Palette */
  --text-primary: #f5f5f7;
  --text-secondary: rgba(235, 235, 245, 0.6);
  --text-placeholder: rgba(235, 235, 245, 0.4);

  /* Accents */
  --accent-purple: #c084fc; /* Tailwind Purple 400 */
  --accent-purple-glow: hsla(262, 92%, 77%, 0.4);
  --accent-purple-glow-intense: hsla(262, 92%, 77%, 0.6);
  --accent-green: #32D74B;
  --accent-red: #FF453A;
  --accent-yellow: #FFD60A;
  --accent-cyan: #22D3EE;
  --accent-cyan-glow: hsla(188, 83%, 50%, 0.6);
  
  /* Glass UI System */
  --glass-panel-background: rgba(30, 30, 30, 0.65);
  --glass-panel-background-hover: rgba(45, 45, 45, 0.75);
  --glass-sidebar-background: rgba(18, 18, 18, 0.7);
  --glass-button-background: hsla(262, 92%, 77%, 0.2);
  --glass-button-background-hover: hsla(262, 92%, 77%, 0.35);
  
  --glass-backdrop-blur: blur(24px) saturate(180%);
  --glass-border: rgba(255, 255, 255, 0.1);
  --glass-border-hover: rgba(255, 255, 255, 0.25);
  --glass-inner-shadow: inset 0 0 1px 1px rgba(255, 255, 255, 0.05);

  /* Separators */
  --separator-primary: rgba(84, 84, 88, 0.65);
  --separator-secondary: rgba(84, 84, 88, 0.4);

  /* Component Overrides (linking to system) */
  --background-secondary: var(--glass-sidebar-background);
  --background-tertiary: var(--glass-panel-background);
  --background-tertiary-hover: var(--glass-panel-background-hover);
  --glass-background-panel: var(--glass-panel-background);
  --glass-background-button: var(--glass-button-background);
  --glass-background-button-hover: var(--glass-button-background-hover);
  --border-glass: var(--glass-border);

  /* Sizing & Z-Index */
  --border-radius-sm: 10px;
  --border-radius-md: 16px;
  --border-radius-lg: 20px;

  --z-header: 50;
  --z-sidebar-mobile-backdrop: 90;
  --z-sidebar-mobile: 100;
  --z-modal: 110;
  --z-notification: 120;
  --z-table-header: 10;
}

/* --- 1. Base Setup & Background --- */
html {
  height: 100%;
  background-color: #000; /* Fallback color */
}

body {
  min-height: 100vh;
  min-height: 100dvh;
  background-color: transparent;
  color: var(--text-primary);
  font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-tap-highlight-color: transparent;
}

#root {
  height: 100%;
  position: relative;
  isolation: isolate; /* Creates a stacking context for the ::before pseudo-element */
}

#root::before {
  content: '';
  position: fixed; /* Ensures it covers the viewport and doesn't scroll */
  left: -5%;
  top: -5%;
  width: 110%;
  height: 110%;
  z-index: -1;
  background: url('light-stream-blue-big-sur-kf.jpg') no-repeat center center;
  background-size: cover;
  filter: blur(24px) brightness(0.7); /* Soft blur and slight dimming for readability */
}

/* --- 2. Glass Panel System --- */
.glass-panel,
.static-glow-border,
.interactive-glow-border,
.modal-panel,
.input-base,
input[type="text"],
input[type="number"],
input[type="date"],
select,
header,
aside {
  background-color: var(--glass-panel-background);
  -webkit-backdrop-filter: var(--glass-backdrop-blur);
  backdrop-filter: var(--glass-backdrop-blur);
  border: 1px solid var(--glass-border);
  box-shadow: var(--glass-inner-shadow);
  transition: box-shadow 0.3s ease, transform 0.2s ease, border-color 0.3s ease, background-color 0.3s ease;
}

header, aside {
  background-color: var(--glass-sidebar-background);
}

.interactive-glow-border:hover,
.interactive-glow-border:focus-visible {
  background-color: var(--glass-panel-background-hover);
  border-color: var(--glass-border-hover);
  box-shadow: var(--glass-inner-shadow), 0 0 12px var(--accent-purple-glow);
  transform: translateY(-1px);
}

/* --- 3. Component-Specific Styling --- */
h1, h2 {
  text-shadow: 0 0 12px var(--accent-purple-glow);
}

.modal-panel {
  box-shadow: 0 16px 40px rgba(0, 0, 0, 0.5);
}

.input-base, input, select {
  border-radius: var(--border-radius-md);
  padding: 10px 14px;
  width: 100%;
}
.input-base::placeholder, input::placeholder { color: var(--text-placeholder); }
.input-base:focus, input:focus, select:focus { outline: none; }
.input-base:focus-visible, input:focus-visible, select:focus-visible {
  border-color: var(--accent-purple);
  box-shadow: 0 0 12px var(--accent-purple-glow), var(--glass-inner-shadow);
}

/* --- 4. Utilities & Overrides --- */
::-webkit-scrollbar { width: 8px; height: 8px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background-color: rgba(255, 255, 255, 0.2); border-radius: 4px; }
::-webkit-scrollbar-thumb:hover { background-color: rgba(255, 255, 255, 0.3); }

.rounded-lg { border-radius: var(--border-radius-lg); }
.rounded-md { border-radius: var(--border-radius-md); }
.rounded-sm { border-radius: var(--border-radius-sm); }

.text-xxs {
  font-size: 0.65rem;
  line-height: 0.9rem;
}

.isolated-scroll {
  overscroll-behavior: contain;
}

/* Sidebar safe area padding */
.sidebar-content-area {
    padding: 0.75rem;
    padding-left: calc(0.75rem + env(safe-area-inset-left));
    padding-right: calc(0.75rem + env(safe-area-inset-right));
    padding-top: calc(0.75rem + env(safe-area-inset-top));
    padding-bottom: calc(3rem + env(safe-area-inset-bottom));
}

/* Dragging state */
html.is-dragging-item,
body.is-dragging-item {
  overflow: hidden !important;
  overscroll-behavior: none !important;
  touch-action: none !important;
  -webkit-touch-callout: none !important;
  user-select: none !important;
}
.topic-list-item.is-dragging {
  opacity: 0.95;
  transform: scale(1.03);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
  background-color: var(--glass-panel-background-hover);
  z-index: 10;
  position: relative;
}
.drag-handle {
  padding: 12px 10px; margin: -12px -10px; margin-right: 12px;
  touch-action: none;
}

/* --- Animation & Focus --- */
.animate-fade-in { animation: fadeIn 0.3s ease-in-out; }
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

*:focus-visible {
    outline: none;
    box-shadow: 0 0 0 2px var(--glass-sidebar-background), 0 0 0 4px var(--accent-purple), 0 0 12px 4px var(--accent-purple-glow-intense);
}
/* Disable focus ring for elements that have their own focus styles */
.input-base:focus-visible, input:focus-visible, .modal-panel *:focus-visible, .btn:focus-visible, [role="button"]:focus-visible, button:focus-visible {
    box-shadow: none;
}

/* --- Print Styles --- */
@media print {
  @page {
    size: A4 portrait;
    margin: 0.75in;
  }
  html, body {
    background: #fff !important;
    color: #000 !important;
  }
  .schedule-report-day {
    break-inside: avoid;
    padding: 1rem;
    border: 1px solid #d1d5db;
    border-radius: 0.5rem;
  }
  .new-week-page-break {
    break-before: page;
  }
}
